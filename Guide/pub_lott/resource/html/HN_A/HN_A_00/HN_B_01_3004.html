<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- 공통 meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>하나은행</title>
    <!-- 공통 css -->
    <link rel="stylesheet" href="../../../../resource/css/common.css" type="text/css">
    <link rel="stylesheet" href="../../../../resource/css/components.css" type="text/css">
    <link rel="stylesheet" href="../../../../resource/css/bank.css" type="text/css">
    <link rel="stylesheet" href="../../../../resource/css/prodmall.css" type="text/css">
</head>

<body>
    <div id="wrap" class="wrap n22UI moneybox challenge-enter-amount">
        <!-- HEADER -->
        <div id="header" class="app-header">
            <button class="app-header__button app-header__button--back" title="이전 화면"></button>
            <h1 class="app-header__title">챌린지</h1>
            <button class="app-header__button app-header__button--home" title="메인 화면"></button>
            <button class="app-header__button app-header__button--hamburger" title="전체 메뉴"></button>
        </div>
        <!-- //HEADER -->

        <!-- CONTENT -->
        <div id="content" class="app-main moneybox-cont pd-btm-none">
            <div class="how-collect">
                <em>매일 얼마씩 모을까요?</em>
                <!--2022-08-30 | 챌린지 금액 입력 수정-->
                <div class="target-amount">
                    <div class="input native-readonly underline-type"><!-- 2022-07-25 price-inp-inline 클래스를 underline-type 로 모두 교체 -->
                        <!--
                            * 오류시 class="input input--error"
                            * 데이터가 초기에 자동으로 입력되어 있을때 class="input input--on"
                        -->
                        <div class="input__inner">
                            <div class="native-inner" role="button">
                                <!-- 2022-08-03 금액 입력폼 contenteditable속성 제거 -->
                                <span id="localKeyPadResult" class="input__element" title="가입금액 입력" placeholder="1천원 이상 ~ 10만원 이하"></span>
                            </div>
                            <button type="button" class="input__remove-button" title="텍스트삭제" style="display: none;"></button>
                        </div>
                    </div>
                    <div class="possible-info-wrap">
                        <em>출금가능금액</em>
                        <p>500,000<span>원</span></p>
                    </div>
                    <!--2022-09-16 | 챌린지 금액 입력 수정 위치변경 -->
                    <p class="worring-text" style="display:none">잔액이 부족해요</p>
                    <!-- 2022-09-16 천원단위가 안될경우 메시지 출력
                         천원 단위로 입금 할 수 있어요
                    -->
                    <!-- 2022-09-01 추가 -->
                    <div class="weekly-challenge">
                        <p><span>1</span>주 동안 <span>70,000</span>원 모으기</p>
                    </div>
                    <!-- 추후 사용될 영역 -->
                    <div class="under-toggle">
                        <em>매일 <span class="point-color1">자동으로 입금</span> 할래요.</em>
                        <label class="switch" for="selectAuto1" data-input-selector="checkbox">
                            <input type="checkbox" id="selectAuto1" data-input-name="checkbox-1" data-input-target="checkbox-section-1" aria-expanded="true" title="만기 시 SMS 알림 여부 선택" checked="">
                            <span class="switch__toggle" aria-hidden="true"></span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="number-pad-wrap">
                <ul class="number-pad">
                    <li>
                        <button type="button" class="number-button" title="넘버패드" data-element="" data-target="" aria-controls="" >1</button>
                    </li>
                    <li><button type="button" class="number-button" title="넘버패드" data-element="" data-target="" aria-controls="" >2</button></li>
                    <li><button type="button" class="number-button" title="넘버패드" data-element="" data-target="" aria-controls="" >3</button></li>
                    <li><button type="button" class="number-button" title="넘버패드" data-element="" data-target="" aria-controls="" >4</button></li>
                    <li><button type="button" class="number-button" title="넘버패드" data-element="" data-target="" aria-controls="" >5</button></li>
                    <li><button type="button" class="number-button" title="넘버패드" data-element="" data-target="" aria-controls="" >6</button></li>
                    <li><button type="button" class="number-button" title="넘버패드" data-element="" data-target="" aria-controls="" >7</button></li>
                    <li><button type="button" class="number-button" title="넘버패드" data-element="" data-target="" aria-controls="" >8</button></li>
                    <li><button type="button" class="number-button" title="넘버패드" data-element="" data-target="" aria-controls="" >9</button></li>
                    <li><button type="button" class="number-button" title="넘버패드" data-element="" data-target="" aria-controls="" >00</button></li>
                    <li><button type="button" class="number-button" title="넘버패드" data-element="" data-target="" aria-controls="" >0</button></li>
                    <li><button type="button" class="number-button num-delete" title="넘버패드" data-element="" data-target="" aria-controls="" ></button></li>
                </ul>
            </div>

            <div class="contents-footer-button">

                <div class="progress-button">
                    <div class="button-wrap">
                        <button type="button" class="button button--positive">확인</button>
                    </div>
                </div>
            </div>
            
        </div>
        <!-- //CONTENT -->

        
    </div>



    <!-- 공통 script -->
    <script src="../../../../resource/library/jquery/jquery-3.4.1.min.js"></script>
    <script src="../../../../resource/library/ui/jquery-ui.js"></script>
    <script src="../../../../resource/library/jquery/jquery.ui.touch-punch.min.js"></script>
    <script src="../../../../resource/library/slick/slick.js"></script>
    <script src="../../../../resource/library/dnd/touch-dnd.js"></script>
    <script src="../../../../resource/js/ui/pualugin.js"></script>
    <script src="../../../../resource/js/ui/common.js"></script>
    <script src="../../../../resource/js/ui/common_n22UI.js"></script>
    <script type="text/javascript">
        var localKeypad = function(obj){
            var warpper = $(obj);
            if(!warpper.length){ return false;}
            var resultObj;
            var available;
            var localKeyPadResult = "";
            var maxAvailable = 0;
            var totalMoney = 0;
            var parkingVal = 0;
            var isParkingCategory = false;
            var realAvailable = 0;
            var inpDisable = false;
            var pageType = "";
            var wonUnit = ['원','만원', '억원'];
            var isWeek = 2;
            /*
                샘플 세팅 데이터 
                isWeek = 몇주 챌린지인지 숫자로 
                isParkingCategory =  파킹 금액조절화면일경우 true로 변경 필요
                available :  분류가능금액
                parkingVal  : 보관금액
                totalMoney  :  보관금액 + 분류가능금액
                realAvailable : 최대한도금액 - 보관금액
                pageType : 더하기 화면인지 뺴기 화면인지 에 따라 문자열 "plus" or "minus" 할당;
            */
            
            function init(){
                resultObj = $('#localKeyPadResult');
                //====== DEV set =============
                pageType = "plus"; 
                available = 500000000;//분류가능금액
                parkingVal = 1000000;//파킹된 금액

                realAvailable = available - parkingVal;
                //파킹화면 아닌경우가 defalut set입니다.
                
                //if 파킹화면일경우
                isParkingCategory = true; //파킹 화면이라면 true
                maxAvailable = 2000000 //최대 설정한도 금액을 200만으로 제한
                //================ DEV set ===

                if(maxAvailable) { //한도 설정 금액이 존재한다면 적용
                    realAvailable = maxAvailable - parkingVal;
                }
            }

            function hanglePrice(price){
                var _priceStr = price.split(',').join('');
                var inpResult2 = 0;
                if(_priceStr.length > 4){//만
                    if(_priceStr.slice(_priceStr.length-4, _priceStr.length) == "0000"){
                        inpResult2 = _priceStr.slice(0,_priceStr.length-4) +  "만원";
                    }else{
                        inpResult2 = _priceStr.slice(0,_priceStr.length-4) +  "만" + _priceStr.slice(_priceStr.length-4, _priceStr.length) + "원";
                    }
                    
                }else{
                    inpResult2 = price + '원';
                }
                return inpResult2;
            }

            //2022-09-01 수정
            function event(){
                //출금가능금액 tap시
                availableObj = $('.possible-info-wrap');

                /*
                availableObj.on('click', function(){
                    var movePrice = availableObj.find('p').text().split('원')[0].split(',').join('');
                    var inpResult = new Intl.NumberFormat('ko-KR').format(movePrice);
                    resultObj.text(inpResult);
                    $('.about-money').html('<p class="'+pageType+'-number">'+hanglePrice(inpResult)+'</p>');
                })
                */
                

                warpper.find('.number-button').click(function(){
                    var _me = $(this);
                    if(_me.is('.num-delete')){//삭제 클릭시
                        inpDisable = false;
                        
                        localKeyPadResult = localKeyPadResult.slice(0, -1);
                    }else{
                        if(!inpDisable){
                            localKeyPadResult += _me.text();
                        }
                    }
                    
                    var inpResult = new Intl.NumberFormat('ko-KR').format(localKeyPadResult);
                    var descResult = parseInt(inpResult.split(',').join(''));
                    
                    //2022-08-26 추가
                    if(!localKeyPadResult.length){
                        inpResult = '';
                        $('.target-amount .input').removeClass('input--focus');
                        $( '.input__inner').find('.won').text('');
                    }else{
                        $('.target-amount .input').addClass('input--focus');
                        $( '.input__inner').find('.won').text('원');
                    }

                    if(realAvailable < descResult){ //가능금액보다 크다면
                        inpDisable = true;//삭제 전까지 추가 입력 방지
                        /*
                        if(isParkingCategory){//파킹카테고리라면
                            $('.about-money').html('<p class="direct-cash-guide">최대 200만원까지 보관할 수 있어요</p>')
                        }else{//그외
                            $('.about-money').html('<p class="direct-cash-guide insuff-cash">잔액이 부족해요</p>')
                        }
                        */
                        $('.worring-text').show();
                        $('.possible-info-wrap').hide();
                    }else{
                        
                        $('.worring-text').hide();
                        $('.possible-info-wrap').show();
                        

                        resultObj.text(inpResult);
                        //$('.plus-info-wrap p').html(new Intl.NumberFormat('ko-KR').format(isWeek * parseInt(inpResult)) + "<span>원</span>")
                        
                        
                        inpResult2 = hanglePrice(inpResult);
                        //console.log(inpResult2, parseInt(inpResult.split(',').join()))
                        
                        //$('.about-money').html('<p class="'+pageType+'-number">'+inpResult2+'</p>')
                    }

                    
                })
                //2022-09-01 | 챌린지 금액 입력 수정
                $( '.input__inner').append( '<span class="won"></span>' );
            }
            init();
            event();
        }
        $(document).ready(function(){
            localKeypad('.number-pad-wrap')
        })
        
    </script>
</body>
</html>