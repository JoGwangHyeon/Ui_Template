<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- 공통 meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>하나은행</title>
    <!-- 공통 css -->
    <link rel="stylesheet" href="../../../../resource/css/common.css" type="text/css">
    <link rel="stylesheet" href="../../../../resource/css/components.css" type="text/css">
    <link rel="stylesheet" href="../../../../resource/css/bank.css" type="text/css">
    <link rel="stylesheet" href="../../../../resource/css/prodmall.css" type="text/css">
</head>

<body>
    <div id="wrap" class="wrap n22UI moneybox">
        <!-- HEADER -->
        <div id="header" class="app-header">
            <button class="app-header__button app-header__button--back" title="이전 화면"></button>
            <h1 class="app-header__title">가계부</h1>
            <button class="app-header__button app-header__button--home" title="메인 화면"></button>
            <button class="app-header__button app-header__button--hamburger" title="전체 메뉴"></button>
        </div>
        <!-- //HEADER -->

        <!-- CONTENT -->
        <div id="content" class="app-main moneybox-cont moneybox-detail">
            <!--2022-08-11 | 가계부 간격 수정-->
            <div class="household-income account-book">
                <!--2022-08-04 | -->
                <div class="parking-graybox">
                    <div class="button-select underline-type inline selected">
                        <!-- 2022-08-30 동기화버튼 추가 -->
                        <button class="synk-btn"></button>
                        <!-- select 버튼에 추가 | data-element="modal__open" data-target="모달 레이어팝업 id 값 예)#combobox_1" -->
                        <div class="the-amount">
                            <!-- 2022-08-26 | 숫자, 문자 구분 span 태그 추가-->
                            <button type="button" class="button button-select__item" title="저축 방식 선택" data-element="modal__open" data-target="#combobox_1" aria-controls="#combobox_2">
                                <span>6</span>월 지출
                            </button>
                        </div>
                        <!--2022-08-22 | 버튼으로 수정-->
                        <!-- 2022-09-22 마크업 수정 -->
                        <button class="the-balance" data-ecrm="Ler1010"><em>2,500,000</em> <span class="unit">원</span></button>
                    </div>
                    <div class="plus-info-wrap">
                        <div>
                            <em>수입</em>
                            <button type="button" class="go_to_income_detail" title="수입" data-ecrm="Ler1020" data-ecrm="Ler1020">5,000,000<span>원</span></button>
                        </div>
                        <div>
                            <em>합계 <span>(수입-지출)</span></em>
                            <p>2,500,000<span>원</span></p>
                        </div>
                    </div>
                    
                    <div id="columnChart" class="graph-area">
                        그래프
                    </div>
                </div>

                <div class="usage-history">
                    <strong>통장내역</strong>
                    <ul class="usage-history-scroll">
                        <li>
                            <div class="history-circle">
                                <p>일</p>
                                <em>19</em>
                            </div>
                            <span>-100,000</span>
                            <span class="color-green">4,000,000</span>
                        </li>
                        <li class="is__active">
                            <div class="history-circle">
                                <p>일</p>
                                <em>19</em>
                            </div>
                            <span>-100,000</span>
                            <span class="color-green">4,000,000</span>
                        </li>
                        <li class="disabled">
                            <div class="history-circle">
                                <p>일</p>
                                <em>19</em>
                            </div>
                            <span>-100,000</span>
                            <span class="color-green">4,000,000</span>
                        </li>
                        <li class="disabled">
                            <div class="history-circle">
                                <p>일</p>
                                <em>19</em>
                            </div>
                            <span>-100,000</span>
                            <span class="color-green">4,000,000</span>
                        </li>
                        <li class="disabled">
                            <div class="history-circle">
                                <p>일</p>
                                <em>19</em>
                            </div>
                            <span>-100,000</span>
                            <span class="color-green">4,000,000</span>
                        </li>
                        <li class="disabled">
                            <div class="history-circle">
                                <p>일</p>
                                <em>19</em>
                            </div>
                            <span>-100,000</span>
                            <span class="color-green">4,000,000</span>
                        </li>
                        <li class="disabled">
                            <div class="history-circle">
                                <p>일</p>
                                <em>19</em>
                            </div>
                            <span>-100,000</span>
                            <span class="color-green">4,000,000</span>
                        </li>
                        
                    </ul>
                </div>

                <div class="pay-list">
                    <div class="pay-list-upper">
                        <em class="pay-list-date">2022.06.19</em>
                    </div>
                    <ul>
                        <li>
                            <!-- 2022-08-30 지출/수입 발생 대상, 시간 위치 변경 -->
                            <!-- 2022-08-30 부가설명 추가(class="pay-list-add-ex") -->
                            <div class="pay-list-left">
                                <span class="pay-list-right-time">16:57:00</span>
                                <div class="pay-list-amount-wrap">
                                    <span class="pay-list-add-ex">대체</span>                                    
                                    <button class="pay-list-left-modify"></button>
                                </div>
                                
                            </div>
                            <div class="pay-list-right">
                                <div class="pay-list-amount-wrap">
                                    <span class="pay-list-left-tit">챌린지 이벤트 참여</span>
                                    <span class="pay-list-amount color-green">+23,000원</span>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="pay-list-left">
                                <span class="pay-list-right-time">16:57:00</span>
                                <div class="pay-list-amount-wrap">
                                    <span class="pay-list-add-ex">현금</span>                                    
                                    <button class="pay-list-left-modify"></button>
                                </div>
                            </div>
                            <div class="pay-list-right">
                                <div class="pay-list-amount-wrap">
                                    <span class="pay-list-left-tit"><em>[취소]</em>쿠팡(쿠페이)</span>
                                    <span class="pay-list-amount">-23,000원</span>
                                </div>
                                <span class="pay-list-right-time">생필품 구매 생필품 구매 생필품</span>
                            </div>
                        </li>
                        <!--2022-08-10 | 토글 비활성화 시(disabled 클래스 추가) 해당 금액 비활성화 처리  -->
                        <li>
                            <div class="pay-list-left">
                                <span class="pay-list-right-time">16:57:00</span>
                                <div class="pay-list-left-amount-wrap">
                                    <span class="pay-list-add-ex">대체</span>                                    
                                    <button class="pay-list-left-modify"></button>
                                </div>
                            </div>
                            <div class="pay-list-right">
                                <div class="pay-list-amount-wrap">
                                    <span class="pay-list-left-tit">타행이체(기업은행)</span>
                                    <span class="pay-list-amount">-23,000원</span>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="pay-list-left">
                                <span class="pay-list-right-time">16:57:00</span>
                                <div class="pay-list-left-amount-wrap">
                                    <span class="pay-list-add-ex">대체</span>                                    
                                    <button class="pay-list-left-modify"></button>
                                </div>
                            </div>
                            <div class="pay-list-right">
                                <div class="pay-list-amount-wrap">
                                    <span class="pay-list-left-tit">타행이체(기업은행)</span>
                                    <span class="pay-list-amount">-23,000원</span>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="pay-list-left">
                                <span class="pay-list-right-time">16:57:00</span>
                                <div class="pay-list-left-amount-wrap">
                                    <span class="pay-list-add-ex">현금</span>                                    
                                    <button class="pay-list-left-modify"></button>
                                </div>
                            </div>
                            <div class="pay-list-right">
                                <div class="pay-list-amount-wrap">
                                    <span class="pay-list-left-tit">챌린지 이벤트 참여</span>
                                    <span class="pay-list-amount color-green">+23,000원</span>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="pay-list-left">
                                <span class="pay-list-right-time">16:57:00</span>
                                <div class="pay-list-left-amount-wrap">
                                    <span class="pay-list-add-ex">대체</span>                                    
                                    <button class="pay-list-left-modify"></button>
                                </div>
                            </div>
                            <div class="pay-list-right">
                                <div class="pay-list-amount-wrap">
                                    <span class="pay-list-left-tit">챌린지 이벤트 참여</span>
                                    <span class="pay-list-amount color-green">+23,000원</span>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="pay-list-left">
                                <span class="pay-list-right-time">16:57:00</span>
                                <div class="pay-list-left-amount-wrap">
                                    <span class="pay-list-add-ex">대체</span>                                    
                                    <button class="pay-list-left-modify"></button>
                                </div>
                            </div>
                            <div class="pay-list-right">
                                <div class="pay-list-amount-wrap">
                                    <span class="pay-list-left-tit">타행이체(기업은행)</span>
                                    <span class="pay-list-amount">-23,000원</span>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="pay-list-left">
                                <span class="pay-list-right-time">16:57:00</span>
                                <div class="pay-list-left-amount-wrap">
                                    <span class="pay-list-add-ex">대체</span>                                    
                                    <button class="pay-list-left-modify"></button>
                                </div>
                            </div>
                            <div class="pay-list-right">
                                <div class="pay-list-amount-wrap">
                                    <span class="pay-list-left-tit">타행이체(기업은행)</span>
                                    <span class="pay-list-amount">-23,000원</span>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="pay-list-left">
                                <span class="pay-list-right-time">16:57:00</span>
                                <div class="pay-list-left-amount-wrap">
                                    <span class="pay-list-add-ex">현금</span>                                    
                                    <button class="pay-list-left-modify"></button>
                                </div>
                            </div>
                            <div class="pay-list-right">
                                <div class="pay-list-amount-wrap">
                                    <span class="pay-list-left-tit">챌린지 이벤트 참여</span>
                                    <span class="pay-list-amount color-green">+23,000원</span>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="pay-list-left">
                                <span class="pay-list-right-time">16:57:00</span>
                                <div class="pay-list-left-amount-wrap">
                                    <span class="pay-list-add-ex">대체</span>                                    
                                    <button class="pay-list-left-modify"></button>
                                </div>
                            </div>
                            <div class="pay-list-right">
                                <div class="pay-list-amount-wrap">
                                    <span class="pay-list-left-tit">챌린지 이벤트 참여</span>
                                    <span class="pay-list-amount color-green">+23,000원</span>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="pay-list-left">
                                <span class="pay-list-right-time">16:57:00</span>
                                <div class="pay-list-left-amount-wrap">
                                    <span class="pay-list-add-ex">대체</span>                                    
                                    <button class="pay-list-left-modify"></button>
                                </div>
                            </div>
                            <div class="pay-list-right">
                                <div class="pay-list-amount-wrap">
                                    <span class="pay-list-left-tit">타행이체(기업은행)</span>
                                    <span class="pay-list-amount">-23,000원</span>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="pay-list-left">
                                <span class="pay-list-right-time">16:57:00</span>
                                <div class="pay-list-left-amount-wrap">
                                    <span class="pay-list-add-ex">대체</span>                                    
                                    <button class="pay-list-left-modify"></button>
                                </div>
                            </div>
                            <div class="pay-list-right">
                                <div class="pay-list-amount-wrap">
                                    <span class="pay-list-left-tit">타행이체(기업은행)</span>
                                    <span class="pay-list-amount">-23,000원</span>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="pay-list-left">
                                <span class="pay-list-right-time">16:57:00</span>
                                <div class="pay-list-left-amount-wrap">
                                    <span class="pay-list-add-ex">현금</span>                                    
                                    <button class="pay-list-left-modify"></button>
                                </div>
                            </div>
                            <div class="pay-list-right">
                                <div class="pay-list-amount-wrap">
                                    <span class="pay-list-left-tit">챌린지 이벤트 참여</span>
                                    <span class="pay-list-amount color-green">+23,000원</span>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="pay-list-left">
                                <span class="pay-list-right-time">16:57:00</span>
                                <div class="pay-list-left-amount-wrap">
                                    <span class="pay-list-add-ex">대체</span>                                    
                                    <button class="pay-list-left-modify"></button>
                                </div>
                            </div>
                            <div class="pay-list-right">
                                <div class="pay-list-amount-wrap">
                                    <span class="pay-list-left-tit">챌린지 이벤트 참여</span>
                                    <span class="pay-list-amount color-green">+23,000원</span>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="pay-list-left">
                                <span class="pay-list-right-time">16:57:00</span>
                                <div class="pay-list-left-amount-wrap">
                                    <span class="pay-list-add-ex">대체</span>                                    
                                    <button class="pay-list-left-modify"></button>
                                </div>
                            </div>
                            <div class="pay-list-right">
                                <div class="pay-list-amount-wrap">
                                    <span class="pay-list-left-tit">챌린지 이벤트 참여</span>
                                    <span class="pay-list-amount color-green">+23,000원</span>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>

                <button type="button" class="view-more" title="더보기" data-element="" data-target="" aria-controls="">더보기</button>

                <!--2022-08-22 | 하나합 바로가기 버튼 추가-->
                <button type="button" class="hanahap-btn" title="하나합 바로가기" data-ecrm="Inn1010">
                    <div class="hanahap-txt">
                        <strong>맞춤형 자산 관리가 필요하다면</strong>
                        <p>하나합 바로가기</p>
                    </div>
                </button>

            </div>
        </div>
        <!-- 제거
        <button class="top-button" type="button"></button>
        -->
        <!-- //CONTENT -->
    </div>

    <!-- 2022-09-05 공통 Top 버튼
    <div class="floating--top">
        <button type="button" data-ecrm="" onclick="" role="button" class="floating__btn--top" aria-label="맨 위로 이동">
            <i class="ico-floating--arrow"></i>
        </button>
    </div>
    -->

    <!-- 공통 script -->
    <script src="../../../../resource/library/jquery/jquery-3.4.1.min.js"></script>
    <script src="../../../../resource/library/slick/slick.js"></script>
    <script src="../../../../resource/library/dnd/touch-dnd.js"></script>
    <script src="../../../../resource/js/ui/pualugin.js"></script>
    <script src="../../../../resource/js/ui/common.js"></script>
    
    <script src="../../../../resource/js/ui/common_n22UI.js"></script>

    <script type="text/javascript">
        hanaProdUI.scrollCalendar = function(obj){
            var obj = $(obj);
            var _YYYY = 0;
            var _MM = 0;
            /* ==== DEV set
                _YYYY = 출력데이터 해당 년도
                _MM = 출력데이터 해당 월
            */
            _YYYY = 2022;
            _MM = 11;

            
            var itemsWrap = $('.usage-history-scroll');
            var itemTemplate = '\
                <li>\
                    <div class="history-circle">\
                        <p>{{DAY}}</p>\
                        <em>{{DATE}}</em>\
                    </div>\
                    <span>{{TEXT1}}</span>\
                    <span class="color-green">{{TEXT2}}</span>\
                </li>';

            function rtArrayNum(num){
                var arr = new Array(num);
                for(var i = 0; i < num; i++){
                    arr[i] = ((i+1)+"")//.padStart(2, "0"); zerofill
                };
                return arr;
            }
            
            function dateChk(yyyy, m){
                var lastDay = new Date(yyyy,m,0).getDate();
                return lastDay;
            }

            var arrDay = rtArrayNum(31);
            arrDay= arrDay.slice(0, dateChk(_YYYY, _MM));


            //오늘 체크
            var today = new Date();
            var toDayYYYY = today.getFullYear();
            var toDayMM = today.getMonth() +1;
            var toDayDate = today.getDate();
            var dayArr = ['일','월','화','수','목','금','토','일'];
            var todayIdx = 0;
            if(_YYYY == toDayYYYY && _MM == toDayMM){
                var toScrollIdx = toDayDate-1;
                arrDay[toScrollIdx] = "오늘";
                todayIdx = toScrollIdx;
            }
            var resultStr = '';
            
            var initDay = new Date(_YYYY+'-'+(_MM+"").padStart(2, "0")+"-01");
            initDay = initDay.getDay();

            for(var i=0; i<arrDay.length; i++){
                if(initDay >6){
                    initDay = 0;
                }
                resultStr += itemTemplate.replace(/{{DAY}}/, dayArr[initDay]).replace(/{{DATE}}/, arrDay[i]).replace(/{{TEXT1}}/, '-1,000,000,000').replace(/{{TEXT2}}/, '+1,000,000,000');
                initDay++;
            }
            itemsWrap.html(resultStr);
            
            if(_YYYY == toDayYYYY && _MM == toDayMM){
                var tick = itemsWrap.find('li').outerWidth(true);
                var _toXPos = itemsWrap.find('li').eq(toScrollIdx).addClass('is__active').offset().left;
                itemsWrap.find('li').eq(toScrollIdx).nextAll().addClass('disabled')
                itemsWrap.animate({
                    'scrollLeft' : (tick * (toScrollIdx-2))
                },0)
            }

            itemsWrap.find('li').eq(todayIdx).addClass('today');

            itemsWrap.find('li:not(.disabled)').on('click', function(){
                var me = $(this);
                me.addClass('is__active').siblings().removeClass('is__active');
            })
        }


    
        //2022-09-24  DEV set  ============
        var monthArr = ['3월', '4월', '5월', '6월', '7월', '8월']; //조회대상월 
        
        var incomArr = [100, 1000, 100, 50, 1500, 40]; //월별 수입
        var expdArr = [30, 40, 100, 300, 200, 100]; // 월별 지출

        var seriesData =  [{
            color:'#333',
            name : '지출',
            data: expdArr
        },
        {
            color:'#009591',
            name : '수입',
            data: incomArr
        }];
        var clickabled = true; //클릭기능 막기시 false
        //========== 2022-09-24  DEV set  ===

        
        
        //2022-09-24 하이차트 제거 후 html 차트 적용
        function showChart(target){

            var chartWrapper = $(target);
            chartWrapper.each(function(){
                var chartObj = $(this);

                function createChartObj(){
                    var _o = {
                        category : monthArr,
                        series : seriesData,
                        xLineLen : 4,
                        dataLabels : true,
                        templeate : {
                            column:'<li>\
                                        <input type="radio" class="inp-radio" name="chartseries">\
                                        <div class="column-list-item">\
                                            <div class="group">\
                                                {{item}}\
                                                 {{tooltipHTML}}\
                                            </div>\
                                            <em class="category">{{category}}</em></span>\
                                        </div>\
                                    </li>',
                            tooltip : '<div class="tooltip__container" style="bottom:{{maxHeight}}"><div class="tooltip__panel">\
                                            {{value}}\
                                        </div></div>'
                        }
                    },
                    
                    _f = {
                        getMax : function(){
                            if(seriesData.length > 1 ){
                                var aa = seriesData[0].data.concat(seriesData[1].data);
                            }else{
                                var aa = seriesData[0].data.concat([]);
                            }
                            aa.sort(function(a, b){ return b-a});
                            return aa[0];
                        },
                        getPer : function(_sData){
                            var _maxVal = _f.getMax();
                            return Math.floor(((_sData/_maxVal) * 100)) +'%';
                        },
                        getMoreHigh : function(arr){
                            var aa = arr;
                            aa.sort(function(a, b){ return b-a});
                            return aa[0];
                        },
                        getWon : function(localKey){
                            return new Intl.NumberFormat('ko-KR').format(localKey);
                        },                        
                        createArticle : function(){
                            var _arrTooltip = [];
                            var _arrColumn = [];

                            var strLine = '';
                            for(var i=0; i<_o.xLineLen; i++){ strLine += "<span></span>";}
                            
                            $.each(_o.category, function(_idx){                            
                                var tooltipText = '';
                                var columnItemText = '';
                                var maxheight = [];

                                $.each(seriesData, function(_sidx){
                                    var _data = this;
                                    if(_o.dataLabels){
                                        tooltipText += '<em style="color:'+_data.color+';"><span class="cate">'+_data.name+'</span><span>'+ _f.getWon(_data.data[_idx]) +' 원</span></em>';
                                    }else{
                                        tooltipText += '<em style="color:'+_data.color+';"><span>'+ _f.getWon(_data.data[_idx]) +' 원</span></em>';
                                    }
                                    maxheight.push(_data.data[_idx]);
                                    columnItemText += '<span class="column-item" style="background:'+_data.color+'; height:'+ _f.getPer(_data.data[_idx]) +'"></span>';
                                });
                                var tooltip = _o.templeate.tooltip.replace('{{maxHeight}}',(_f.getPer(_f.getMoreHigh(maxheight))+'')).replace('{{value}}',tooltipText);
                                
                                if(!clickabled){
                                    _arrColumn.push(_o.templeate.column.replace('<input type="radio" class="inp-radio" name="chartseries">','<input type="radio" class="inp-radio" name="chartseries" disabled>').replace('{{category}}', _o.category[_idx]).replace('{{tooltipHTML}}', tooltip).replace('{{item}}', columnItemText));    
                                }else{
                                    _arrColumn.push(_o.templeate.column.replace('{{category}}', _o.category[_idx]).replace('{{tooltipHTML}}', tooltip).replace('{{item}}', columnItemText));
                                }
                            })
                            chartObj.html('<div class="bg-liner">' + strLine + '</div> <ul>' + _arrColumn.join("") + '</ul>');
                            chartObj.removeClass('init')
                            setTimeout(function(){
                                chartObj.addClass('init');
                            },20)
                            if(_o.dataLabels){
                                var dataLabelsText = "";
                                $.each(seriesData, function(_sidx){
                                    var _data = this;
                                    dataLabelsText += '<em><span style="background-color:'+_data.color + ';"></span><span class="cate">'+_data.name+'</span></em>'
                                })
                                $('<div class="data-labels">'+ dataLabelsText +'</div>').prependTo(chartObj)
                            }
                        }
                    };
                    _f.createArticle();
                }

                function init(){
                    createChartObj();
                }

                init();
            })

            //event 
            
            $('.graph-area').on('click', '.inp-radio', function(){
                $('.graph-area').addClass('is-active');
            })
			//columnChart : 화면상 div id
        }


            
        $(document).ready(function(){
            hanaprodMainUI.sticky('.usage-history');
            hanaprodMainUI.sticky('.usage-history');
            hanaProdUI.scrollCalendar('.usage-history');

            showChart('.graph-area');
        });
    </script>
</body>
</html>